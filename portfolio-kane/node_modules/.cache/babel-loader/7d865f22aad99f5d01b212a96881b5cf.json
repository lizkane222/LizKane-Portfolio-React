{"ast":null,"code":"/*\n * File: iframeResizer.contentWindow.js\n * Desc: Include this file in any page being loaded into an iframe\n *       to force the iframe to resize to the content size.\n * Requires: iframeResizer.js on host page.\n * Doc: https://github.com/davidjbradshaw/iframe-resizer\n * Author: David J. Bradshaw - dave@bradshaw.net\n *\n */\n// eslint-disable-next-line sonarjs/cognitive-complexity, no-shadow-restricted-names\n;\n\n(function (undefined) {\n  if (typeof window === 'undefined') return; // don't run for server side render\n\n  var autoResize = true,\n      base = 10,\n      bodyBackground = '',\n      bodyMargin = 0,\n      bodyMarginStr = '',\n      bodyObserver = null,\n      bodyPadding = '',\n      calculateWidth = false,\n      doubleEventList = {\n    resize: 1,\n    click: 1\n  },\n      eventCancelTimer = 128,\n      firstRun = true,\n      height = 1,\n      heightCalcModeDefault = 'bodyOffset',\n      heightCalcMode = heightCalcModeDefault,\n      initLock = true,\n      initMsg = '',\n      inPageLinks = {},\n      interval = 32,\n      intervalTimer = null,\n      logging = false,\n      msgID = '[iFrameSizer]',\n      // Must match host page msg ID\n  msgIdLen = msgID.length,\n      myID = '',\n      resetRequiredMethods = {\n    max: 1,\n    min: 1,\n    bodyScroll: 1,\n    documentElementScroll: 1\n  },\n      resizeFrom = 'child',\n      sendPermit = true,\n      target = window.parent,\n      targetOriginDefault = '*',\n      tolerance = 0,\n      triggerLocked = false,\n      triggerLockedTimer = null,\n      throttledTimer = 16,\n      width = 1,\n      widthCalcModeDefault = 'scroll',\n      widthCalcMode = widthCalcModeDefault,\n      win = window,\n      onMessage = function onMessage() {\n    warn('onMessage function not defined');\n  },\n      onReady = function onReady() {},\n      onPageInfo = function onPageInfo() {},\n      customCalcMethods = {\n    height: function height() {\n      warn('Custom height calculation function not defined');\n      return document.documentElement.offsetHeight;\n    },\n    width: function width() {\n      warn('Custom width calculation function not defined');\n      return document.body.scrollWidth;\n    }\n  },\n      eventHandlersByName = {},\n      passiveSupported = false;\n\n  function noop() {}\n\n  try {\n    var options = Object.create({}, {\n      passive: {\n        get: function get() {\n          passiveSupported = true;\n        }\n      }\n    });\n    window.addEventListener('test', noop, options);\n    window.removeEventListener('test', noop, options);\n  } catch (error) {\n    /* */\n  }\n\n  function addEventListener(el, evt, func, options) {\n    el.addEventListener(evt, func, passiveSupported ? options || {} : false);\n  }\n\n  function removeEventListener(el, evt, func) {\n    el.removeEventListener(evt, func, false);\n  }\n\n  function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  } // Based on underscore.js\n\n\n  function throttle(func) {\n    var context,\n        args,\n        result,\n        timeout = null,\n        previous = 0,\n        later = function later() {\n      previous = getNow();\n      timeout = null;\n      result = func.apply(context, args);\n\n      if (!timeout) {\n        // eslint-disable-next-line no-multi-assign\n        context = args = null;\n      }\n    };\n\n    return function () {\n      var now = getNow();\n\n      if (!previous) {\n        previous = now;\n      }\n\n      var remaining = throttledTimer - (now - previous);\n      context = this;\n      args = arguments;\n\n      if (remaining <= 0 || remaining > throttledTimer) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n\n        previous = now;\n        result = func.apply(context, args);\n\n        if (!timeout) {\n          // eslint-disable-next-line no-multi-assign\n          context = args = null;\n        }\n      } else if (!timeout) {\n        timeout = setTimeout(later, remaining);\n      }\n\n      return result;\n    };\n  }\n\n  var getNow = Date.now || function () {\n    /* istanbul ignore next */\n    // Not testable in PhantonJS\n    return new Date().getTime();\n  };\n\n  function formatLogMsg(msg) {\n    return msgID + '[' + myID + '] ' + msg;\n  }\n\n  function log(msg) {\n    if (logging && 'object' === typeof window.console) {\n      // eslint-disable-next-line no-console\n      console.log(formatLogMsg(msg));\n    }\n  }\n\n  function warn(msg) {\n    if ('object' === typeof window.console) {\n      // eslint-disable-next-line no-console\n      console.warn(formatLogMsg(msg));\n    }\n  }\n\n  function init() {\n    readDataFromParent();\n    log('Initialising iFrame (' + location.href + ')');\n    readDataFromPage();\n    setMargin();\n    setBodyStyle('background', bodyBackground);\n    setBodyStyle('padding', bodyPadding);\n    injectClearFixIntoBodyElement();\n    checkHeightMode();\n    checkWidthMode();\n    stopInfiniteResizingOfIFrame();\n    setupPublicMethods();\n    startEventListeners();\n    inPageLinks = setupInPageLinks();\n    sendSize('init', 'Init message from host page');\n    onReady();\n  }\n\n  function readDataFromParent() {\n    function strBool(str) {\n      return 'true' === str;\n    }\n\n    var data = initMsg.substr(msgIdLen).split(':');\n    myID = data[0];\n    bodyMargin = undefined !== data[1] ? Number(data[1]) : bodyMargin; // For V1 compatibility\n\n    calculateWidth = undefined !== data[2] ? strBool(data[2]) : calculateWidth;\n    logging = undefined !== data[3] ? strBool(data[3]) : logging;\n    interval = undefined !== data[4] ? Number(data[4]) : interval;\n    autoResize = undefined !== data[6] ? strBool(data[6]) : autoResize;\n    bodyMarginStr = data[7];\n    heightCalcMode = undefined !== data[8] ? data[8] : heightCalcMode;\n    bodyBackground = data[9];\n    bodyPadding = data[10];\n    tolerance = undefined !== data[11] ? Number(data[11]) : tolerance;\n    inPageLinks.enable = undefined !== data[12] ? strBool(data[12]) : false;\n    resizeFrom = undefined !== data[13] ? data[13] : resizeFrom;\n    widthCalcMode = undefined !== data[14] ? data[14] : widthCalcMode;\n  }\n\n  function depricate(key) {\n    var splitName = key.split('Callback');\n\n    if (splitName.length === 2) {\n      var name = 'on' + splitName[0].charAt(0).toUpperCase() + splitName[0].slice(1);\n      this[name] = this[key];\n      delete this[key];\n      warn(\"Deprecated: '\" + key + \"' has been renamed '\" + name + \"'. The old method will be removed in the next major version.\");\n    }\n  }\n\n  function readDataFromPage() {\n    function readData() {\n      var data = window.iFrameResizer;\n      log('Reading data from page: ' + JSON.stringify(data));\n      Object.keys(data).forEach(depricate, data);\n      onMessage = 'onMessage' in data ? data.onMessage : onMessage;\n      onReady = 'onReady' in data ? data.onReady : onReady;\n      targetOriginDefault = 'targetOrigin' in data ? data.targetOrigin : targetOriginDefault;\n      heightCalcMode = 'heightCalculationMethod' in data ? data.heightCalculationMethod : heightCalcMode;\n      widthCalcMode = 'widthCalculationMethod' in data ? data.widthCalculationMethod : widthCalcMode;\n    }\n\n    function setupCustomCalcMethods(calcMode, calcFunc) {\n      if ('function' === typeof calcMode) {\n        log('Setup custom ' + calcFunc + 'CalcMethod');\n        customCalcMethods[calcFunc] = calcMode;\n        calcMode = 'custom';\n      }\n\n      return calcMode;\n    }\n\n    if ('iFrameResizer' in window && Object === window.iFrameResizer.constructor) {\n      readData();\n      heightCalcMode = setupCustomCalcMethods(heightCalcMode, 'height');\n      widthCalcMode = setupCustomCalcMethods(widthCalcMode, 'width');\n    }\n\n    log('TargetOrigin for parent set to: ' + targetOriginDefault);\n  }\n\n  function chkCSS(attr, value) {\n    if (-1 !== value.indexOf('-')) {\n      warn('Negative CSS value ignored for ' + attr);\n      value = '';\n    }\n\n    return value;\n  }\n\n  function setBodyStyle(attr, value) {\n    if (undefined !== value && '' !== value && 'null' !== value) {\n      document.body.style[attr] = value;\n      log('Body ' + attr + ' set to \"' + value + '\"');\n    }\n  }\n\n  function setMargin() {\n    // If called via V1 script, convert bodyMargin from int to str\n    if (undefined === bodyMarginStr) {\n      bodyMarginStr = bodyMargin + 'px';\n    }\n\n    setBodyStyle('margin', chkCSS('margin', bodyMarginStr));\n  }\n\n  function stopInfiniteResizingOfIFrame() {\n    document.documentElement.style.height = '';\n    document.body.style.height = '';\n    log('HTML & body height set to \"auto\"');\n  }\n\n  function manageTriggerEvent(options) {\n    var listener = {\n      add: function add(eventName) {\n        function handleEvent() {\n          sendSize(options.eventName, options.eventType);\n        }\n\n        eventHandlersByName[eventName] = handleEvent;\n        addEventListener(window, eventName, handleEvent, {\n          passive: true\n        });\n      },\n      remove: function remove(eventName) {\n        var handleEvent = eventHandlersByName[eventName];\n        delete eventHandlersByName[eventName];\n        removeEventListener(window, eventName, handleEvent);\n      }\n    };\n\n    if (options.eventNames && Array.prototype.map) {\n      options.eventName = options.eventNames[0];\n      options.eventNames.map(listener[options.method]);\n    } else {\n      listener[options.method](options.eventName);\n    }\n\n    log(capitalizeFirstLetter(options.method) + ' event listener: ' + options.eventType);\n  }\n\n  function manageEventListeners(method) {\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Animation Start',\n      eventNames: ['animationstart', 'webkitAnimationStart']\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Animation Iteration',\n      eventNames: ['animationiteration', 'webkitAnimationIteration']\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Animation End',\n      eventNames: ['animationend', 'webkitAnimationEnd']\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Input',\n      eventName: 'input'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Mouse Up',\n      eventName: 'mouseup'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Mouse Down',\n      eventName: 'mousedown'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Orientation Change',\n      eventName: 'orientationchange'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Print',\n      eventName: ['afterprint', 'beforeprint']\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Ready State Change',\n      eventName: 'readystatechange'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Touch Start',\n      eventName: 'touchstart'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Touch End',\n      eventName: 'touchend'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Touch Cancel',\n      eventName: 'touchcancel'\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Transition Start',\n      eventNames: ['transitionstart', 'webkitTransitionStart', 'MSTransitionStart', 'oTransitionStart', 'otransitionstart']\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Transition Iteration',\n      eventNames: ['transitioniteration', 'webkitTransitionIteration', 'MSTransitionIteration', 'oTransitionIteration', 'otransitioniteration']\n    });\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Transition End',\n      eventNames: ['transitionend', 'webkitTransitionEnd', 'MSTransitionEnd', 'oTransitionEnd', 'otransitionend']\n    });\n\n    if ('child' === resizeFrom) {\n      manageTriggerEvent({\n        method: method,\n        eventType: 'IFrame Resized',\n        eventName: 'resize'\n      });\n    }\n  }\n\n  function checkCalcMode(calcMode, calcModeDefault, modes, type) {\n    if (calcModeDefault !== calcMode) {\n      if (!(calcMode in modes)) {\n        warn(calcMode + ' is not a valid option for ' + type + 'CalculationMethod.');\n        calcMode = calcModeDefault;\n      }\n\n      log(type + ' calculation method set to \"' + calcMode + '\"');\n    }\n\n    return calcMode;\n  }\n\n  function checkHeightMode() {\n    heightCalcMode = checkCalcMode(heightCalcMode, heightCalcModeDefault, getHeight, 'height');\n  }\n\n  function checkWidthMode() {\n    widthCalcMode = checkCalcMode(widthCalcMode, widthCalcModeDefault, getWidth, 'width');\n  }\n\n  function startEventListeners() {\n    if (true === autoResize) {\n      manageEventListeners('add');\n      setupMutationObserver();\n    } else {\n      log('Auto Resize disabled');\n    }\n  } //   function stopMsgsToParent() {\n  //     log('Disable outgoing messages')\n  //     sendPermit = false\n  //   }\n  //   function removeMsgListener() {\n  //     log('Remove event listener: Message')\n  //     removeEventListener(window, 'message', receiver)\n  //   }\n\n\n  function disconnectMutationObserver() {\n    if (null !== bodyObserver) {\n      /* istanbul ignore next */\n      // Not testable in PhantonJS\n      bodyObserver.disconnect();\n    }\n  }\n\n  function stopEventListeners() {\n    manageEventListeners('remove');\n    disconnectMutationObserver();\n    clearInterval(intervalTimer);\n  } //   function teardown() {\n  //     stopMsgsToParent()\n  //     removeMsgListener()\n  //     if (true === autoResize) stopEventListeners()\n  //   }\n\n\n  function injectClearFixIntoBodyElement() {\n    var clearFix = document.createElement('div');\n    clearFix.style.clear = 'both'; // Guard against the following having been globally redefined in CSS.\n\n    clearFix.style.display = 'block';\n    clearFix.style.height = '0';\n    document.body.appendChild(clearFix);\n  }\n\n  function setupInPageLinks() {\n    function getPagePosition() {\n      return {\n        x: window.pageXOffset !== undefined ? window.pageXOffset : document.documentElement.scrollLeft,\n        y: window.pageYOffset !== undefined ? window.pageYOffset : document.documentElement.scrollTop\n      };\n    }\n\n    function getElementPosition(el) {\n      var elPosition = el.getBoundingClientRect(),\n          pagePosition = getPagePosition();\n      return {\n        x: parseInt(elPosition.left, 10) + parseInt(pagePosition.x, 10),\n        y: parseInt(elPosition.top, 10) + parseInt(pagePosition.y, 10)\n      };\n    }\n\n    function findTarget(location) {\n      function jumpToTarget(target) {\n        var jumpPosition = getElementPosition(target);\n        log('Moving to in page link (#' + hash + ') at x: ' + jumpPosition.x + ' y: ' + jumpPosition.y);\n        sendMsg(jumpPosition.y, jumpPosition.x, 'scrollToOffset'); // X&Y reversed at sendMsg uses height/width\n      }\n\n      var hash = location.split('#')[1] || location,\n          // Remove # if present\n      hashData = decodeURIComponent(hash),\n          target = document.getElementById(hashData) || document.getElementsByName(hashData)[0];\n\n      if (undefined !== target) {\n        jumpToTarget(target);\n      } else {\n        log('In page link (#' + hash + ') not found in iFrame, so sending to parent');\n        sendMsg(0, 0, 'inPageLink', '#' + hash);\n      }\n    }\n\n    function checkLocationHash() {\n      if ('' !== location.hash && '#' !== location.hash) {\n        findTarget(location.href);\n      }\n    }\n\n    function bindAnchors() {\n      function setupLink(el) {\n        function linkClicked(e) {\n          e.preventDefault();\n          /* jshint validthis:true */\n\n          findTarget(this.getAttribute('href'));\n        }\n\n        if ('#' !== el.getAttribute('href')) {\n          addEventListener(el, 'click', linkClicked);\n        }\n      }\n\n      Array.prototype.forEach.call(document.querySelectorAll('a[href^=\"#\"]'), setupLink);\n    }\n\n    function bindLocationHash() {\n      addEventListener(window, 'hashchange', checkLocationHash);\n    }\n\n    function initCheck() {\n      // Check if page loaded with location hash after init resize\n      setTimeout(checkLocationHash, eventCancelTimer);\n    }\n\n    function enableInPageLinks() {\n      /* istanbul ignore else */\n      // Not testable in phantonJS\n      if (Array.prototype.forEach && document.querySelectorAll) {\n        log('Setting up location.hash handlers');\n        bindAnchors();\n        bindLocationHash();\n        initCheck();\n      } else {\n        warn('In page linking not fully supported in this browser! (See README.md for IE8 workaround)');\n      }\n    }\n\n    if (inPageLinks.enable) {\n      enableInPageLinks();\n    } else {\n      log('In page linking not enabled');\n    }\n\n    return {\n      findTarget: findTarget\n    };\n  }\n\n  function setupPublicMethods() {\n    log('Enable public methods');\n    win.parentIFrame = {\n      autoResize: function autoResizeF(resize) {\n        if (true === resize && false === autoResize) {\n          autoResize = true;\n          startEventListeners();\n        } else if (false === resize && true === autoResize) {\n          autoResize = false;\n          stopEventListeners();\n        }\n\n        sendMsg(0, 0, 'autoResize', JSON.stringify(autoResize));\n        return autoResize;\n      },\n      close: function closeF() {\n        sendMsg(0, 0, 'close'); // teardown()\n      },\n      getId: function getIdF() {\n        return myID;\n      },\n      getPageInfo: function getPageInfoF(callback) {\n        if ('function' === typeof callback) {\n          onPageInfo = callback;\n          sendMsg(0, 0, 'pageInfo');\n        } else {\n          onPageInfo = function onPageInfo() {};\n\n          sendMsg(0, 0, 'pageInfoStop');\n        }\n      },\n      moveToAnchor: function moveToAnchorF(hash) {\n        inPageLinks.findTarget(hash);\n      },\n      reset: function resetF() {\n        resetIFrame('parentIFrame.reset');\n      },\n      scrollTo: function scrollToF(x, y) {\n        sendMsg(y, x, 'scrollTo'); // X&Y reversed at sendMsg uses height/width\n      },\n      scrollToOffset: function scrollToF(x, y) {\n        sendMsg(y, x, 'scrollToOffset'); // X&Y reversed at sendMsg uses height/width\n      },\n      sendMessage: function sendMessageF(msg, targetOrigin) {\n        sendMsg(0, 0, 'message', JSON.stringify(msg), targetOrigin);\n      },\n      setHeightCalculationMethod: function setHeightCalculationMethodF(heightCalculationMethod) {\n        heightCalcMode = heightCalculationMethod;\n        checkHeightMode();\n      },\n      setWidthCalculationMethod: function setWidthCalculationMethodF(widthCalculationMethod) {\n        widthCalcMode = widthCalculationMethod;\n        checkWidthMode();\n      },\n      setTargetOrigin: function setTargetOriginF(targetOrigin) {\n        log('Set targetOrigin: ' + targetOrigin);\n        targetOriginDefault = targetOrigin;\n      },\n      size: function sizeF(customHeight, customWidth) {\n        var valString = '' + (customHeight || '') + (customWidth ? ',' + customWidth : '');\n        sendSize('size', 'parentIFrame.size(' + valString + ')', customHeight, customWidth);\n      }\n    };\n  }\n\n  function initInterval() {\n    if (0 !== interval) {\n      log('setInterval: ' + interval + 'ms');\n      intervalTimer = setInterval(function () {\n        sendSize('interval', 'setInterval: ' + interval);\n      }, Math.abs(interval));\n    }\n  } // Not testable in PhantomJS\n\n  /* istanbul ignore next */\n\n\n  function setupBodyMutationObserver() {\n    function addImageLoadListners(mutation) {\n      function addImageLoadListener(element) {\n        if (false === element.complete) {\n          log('Attach listeners to ' + element.src);\n          element.addEventListener('load', imageLoaded, false);\n          element.addEventListener('error', imageError, false);\n          elements.push(element);\n        }\n      }\n\n      if (mutation.type === 'attributes' && mutation.attributeName === 'src') {\n        addImageLoadListener(mutation.target);\n      } else if (mutation.type === 'childList') {\n        Array.prototype.forEach.call(mutation.target.querySelectorAll('img'), addImageLoadListener);\n      }\n    }\n\n    function removeFromArray(element) {\n      elements.splice(elements.indexOf(element), 1);\n    }\n\n    function removeImageLoadListener(element) {\n      log('Remove listeners from ' + element.src);\n      element.removeEventListener('load', imageLoaded, false);\n      element.removeEventListener('error', imageError, false);\n      removeFromArray(element);\n    }\n\n    function imageEventTriggered(event, type, typeDesc) {\n      removeImageLoadListener(event.target);\n      sendSize(type, typeDesc + ': ' + event.target.src, undefined, undefined);\n    }\n\n    function imageLoaded(event) {\n      imageEventTriggered(event, 'imageLoad', 'Image loaded');\n    }\n\n    function imageError(event) {\n      imageEventTriggered(event, 'imageLoadFailed', 'Image load failed');\n    }\n\n    function mutationObserved(mutations) {\n      sendSize('mutationObserver', 'mutationObserver: ' + mutations[0].target + ' ' + mutations[0].type); // Deal with WebKit / Blink asyncing image loading when tags are injected into the page\n\n      mutations.forEach(addImageLoadListners);\n    }\n\n    function createMutationObserver() {\n      var target = document.querySelector('body'),\n          config = {\n        attributes: true,\n        attributeOldValue: false,\n        characterData: true,\n        characterDataOldValue: false,\n        childList: true,\n        subtree: true\n      };\n      observer = new MutationObserver(mutationObserved);\n      log('Create body MutationObserver');\n      observer.observe(target, config);\n      return observer;\n    }\n\n    var elements = [],\n        MutationObserver = window.MutationObserver || window.WebKitMutationObserver,\n        observer = createMutationObserver();\n    return {\n      disconnect: function disconnect() {\n        if ('disconnect' in observer) {\n          log('Disconnect body MutationObserver');\n          observer.disconnect();\n          elements.forEach(removeImageLoadListener);\n        }\n      }\n    };\n  }\n\n  function setupMutationObserver() {\n    var forceIntervalTimer = 0 > interval; // Not testable in PhantomJS\n\n    /* istanbul ignore if */\n\n    if (window.MutationObserver || window.WebKitMutationObserver) {\n      if (forceIntervalTimer) {\n        initInterval();\n      } else {\n        bodyObserver = setupBodyMutationObserver();\n      }\n    } else {\n      log('MutationObserver not supported in this browser!');\n      initInterval();\n    }\n  } // document.documentElement.offsetHeight is not reliable, so\n  // we have to jump through hoops to get a better value.\n\n\n  function getComputedStyle(prop, el) {\n    var retVal = 0;\n    el = el || document.body; // Not testable in phantonJS\n\n    retVal = document.defaultView.getComputedStyle(el, null);\n    retVal = null !== retVal ? retVal[prop] : 0;\n    return parseInt(retVal, base);\n  }\n\n  function chkEventThottle(timer) {\n    if (timer > throttledTimer / 2) {\n      throttledTimer = 2 * timer;\n      log('Event throttle increased to ' + throttledTimer + 'ms');\n    }\n  } // Idea from https://github.com/guardian/iframe-messenger\n\n\n  function getMaxElement(side, elements) {\n    var elementsLength = elements.length,\n        elVal = 0,\n        maxVal = 0,\n        Side = capitalizeFirstLetter(side),\n        timer = getNow();\n\n    for (var i = 0; i < elementsLength; i++) {\n      elVal = elements[i].getBoundingClientRect()[side] + getComputedStyle('margin' + Side, elements[i]);\n\n      if (elVal > maxVal) {\n        maxVal = elVal;\n      }\n    }\n\n    timer = getNow() - timer;\n    log('Parsed ' + elementsLength + ' HTML elements');\n    log('Element position calculated in ' + timer + 'ms');\n    chkEventThottle(timer);\n    return maxVal;\n  }\n\n  function getAllMeasurements(dimention) {\n    return [dimention.bodyOffset(), dimention.bodyScroll(), dimention.documentElementOffset(), dimention.documentElementScroll()];\n  }\n\n  function getTaggedElements(side, tag) {\n    function noTaggedElementsFound() {\n      warn('No tagged elements (' + tag + ') found on page');\n      return document.querySelectorAll('body *');\n    }\n\n    var elements = document.querySelectorAll('[' + tag + ']');\n    if (0 === elements.length) noTaggedElementsFound();\n    return getMaxElement(side, elements);\n  }\n\n  function getAllElements() {\n    return document.querySelectorAll('body *');\n  }\n\n  var getHeight = {\n    bodyOffset: function getBodyOffsetHeight() {\n      return document.body.offsetHeight + getComputedStyle('marginTop') + getComputedStyle('marginBottom');\n    },\n    offset: function offset() {\n      return getHeight.bodyOffset(); // Backwards compatability\n    },\n    bodyScroll: function getBodyScrollHeight() {\n      return document.body.scrollHeight;\n    },\n    custom: function getCustomWidth() {\n      return customCalcMethods.height();\n    },\n    documentElementOffset: function getDEOffsetHeight() {\n      return document.documentElement.offsetHeight;\n    },\n    documentElementScroll: function getDEScrollHeight() {\n      return document.documentElement.scrollHeight;\n    },\n    max: function getMaxHeight() {\n      return Math.max.apply(null, getAllMeasurements(getHeight));\n    },\n    min: function getMinHeight() {\n      return Math.min.apply(null, getAllMeasurements(getHeight));\n    },\n    grow: function growHeight() {\n      return getHeight.max(); // Run max without the forced downsizing\n    },\n    lowestElement: function getBestHeight() {\n      return Math.max(getHeight.bodyOffset() || getHeight.documentElementOffset(), getMaxElement('bottom', getAllElements()));\n    },\n    taggedElement: function getTaggedElementsHeight() {\n      return getTaggedElements('bottom', 'data-iframe-height');\n    }\n  },\n      getWidth = {\n    bodyScroll: function getBodyScrollWidth() {\n      return document.body.scrollWidth;\n    },\n    bodyOffset: function getBodyOffsetWidth() {\n      return document.body.offsetWidth;\n    },\n    custom: function getCustomWidth() {\n      return customCalcMethods.width();\n    },\n    documentElementScroll: function getDEScrollWidth() {\n      return document.documentElement.scrollWidth;\n    },\n    documentElementOffset: function getDEOffsetWidth() {\n      return document.documentElement.offsetWidth;\n    },\n    scroll: function getMaxWidth() {\n      return Math.max(getWidth.bodyScroll(), getWidth.documentElementScroll());\n    },\n    max: function getMaxWidth() {\n      return Math.max.apply(null, getAllMeasurements(getWidth));\n    },\n    min: function getMinWidth() {\n      return Math.min.apply(null, getAllMeasurements(getWidth));\n    },\n    rightMostElement: function rightMostElement() {\n      return getMaxElement('right', getAllElements());\n    },\n    taggedElement: function getTaggedElementsWidth() {\n      return getTaggedElements('right', 'data-iframe-width');\n    }\n  };\n\n  function sizeIFrame(triggerEvent, triggerEventDesc, customHeight, customWidth) {\n    function resizeIFrame() {\n      height = currentHeight;\n      width = currentWidth;\n      sendMsg(height, width, triggerEvent);\n    }\n\n    function isSizeChangeDetected() {\n      function checkTolarance(a, b) {\n        var retVal = Math.abs(a - b) <= tolerance;\n        return !retVal;\n      }\n\n      currentHeight = undefined !== customHeight ? customHeight : getHeight[heightCalcMode]();\n      currentWidth = undefined !== customWidth ? customWidth : getWidth[widthCalcMode]();\n      return checkTolarance(height, currentHeight) || calculateWidth && checkTolarance(width, currentWidth);\n    }\n\n    function isForceResizableEvent() {\n      return !(triggerEvent in {\n        init: 1,\n        interval: 1,\n        size: 1\n      });\n    }\n\n    function isForceResizableCalcMode() {\n      return heightCalcMode in resetRequiredMethods || calculateWidth && widthCalcMode in resetRequiredMethods;\n    }\n\n    function logIgnored() {\n      log('No change in size detected');\n    }\n\n    function checkDownSizing() {\n      if (isForceResizableEvent() && isForceResizableCalcMode()) {\n        resetIFrame(triggerEventDesc);\n      } else if (!(triggerEvent in {\n        interval: 1\n      })) {\n        logIgnored();\n      }\n    }\n\n    var currentHeight, currentWidth;\n\n    if (isSizeChangeDetected() || 'init' === triggerEvent) {\n      lockTrigger();\n      resizeIFrame();\n    } else {\n      checkDownSizing();\n    }\n  }\n\n  var sizeIFrameThrottled = throttle(sizeIFrame);\n\n  function sendSize(triggerEvent, triggerEventDesc, customHeight, customWidth) {\n    function recordTrigger() {\n      if (!(triggerEvent in {\n        reset: 1,\n        resetPage: 1,\n        init: 1\n      })) {\n        log('Trigger event: ' + triggerEventDesc);\n      }\n    }\n\n    function isDoubleFiredEvent() {\n      return triggerLocked && triggerEvent in doubleEventList;\n    }\n\n    if (!isDoubleFiredEvent()) {\n      recordTrigger();\n\n      if (triggerEvent === 'init') {\n        sizeIFrame(triggerEvent, triggerEventDesc, customHeight, customWidth);\n      } else {\n        sizeIFrameThrottled(triggerEvent, triggerEventDesc, customHeight, customWidth);\n      }\n    } else {\n      log('Trigger event cancelled: ' + triggerEvent);\n    }\n  }\n\n  function lockTrigger() {\n    if (!triggerLocked) {\n      triggerLocked = true;\n      log('Trigger event lock on');\n    }\n\n    clearTimeout(triggerLockedTimer);\n    triggerLockedTimer = setTimeout(function () {\n      triggerLocked = false;\n      log('Trigger event lock off');\n      log('--');\n    }, eventCancelTimer);\n  }\n\n  function triggerReset(triggerEvent) {\n    height = getHeight[heightCalcMode]();\n    width = getWidth[widthCalcMode]();\n    sendMsg(height, width, triggerEvent);\n  }\n\n  function resetIFrame(triggerEventDesc) {\n    var hcm = heightCalcMode;\n    heightCalcMode = heightCalcModeDefault;\n    log('Reset trigger event: ' + triggerEventDesc);\n    lockTrigger();\n    triggerReset('reset');\n    heightCalcMode = hcm;\n  }\n\n  function sendMsg(height, width, triggerEvent, msg, targetOrigin) {\n    function setTargetOrigin() {\n      if (undefined === targetOrigin) {\n        targetOrigin = targetOriginDefault;\n      } else {\n        log('Message targetOrigin: ' + targetOrigin);\n      }\n    }\n\n    function sendToParent() {\n      var size = height + ':' + width,\n          message = myID + ':' + size + ':' + triggerEvent + (undefined !== msg ? ':' + msg : '');\n      log('Sending message to host page (' + message + ')');\n      target.postMessage(msgID + message, targetOrigin);\n    }\n\n    if (true === sendPermit) {\n      setTargetOrigin();\n      sendToParent();\n    }\n  }\n\n  function receiver(event) {\n    var processRequestFromParent = {\n      init: function initFromParent() {\n        initMsg = event.data;\n        target = event.source;\n        init();\n        firstRun = false;\n        setTimeout(function () {\n          initLock = false;\n        }, eventCancelTimer);\n      },\n      reset: function resetFromParent() {\n        if (!initLock) {\n          log('Page size reset by host page');\n          triggerReset('resetPage');\n        } else {\n          log('Page reset ignored by init');\n        }\n      },\n      resize: function resizeFromParent() {\n        sendSize('resizeParent', 'Parent window requested size check');\n      },\n      moveToAnchor: function moveToAnchorF() {\n        inPageLinks.findTarget(getData());\n      },\n      inPageLink: function inPageLinkF() {\n        this.moveToAnchor();\n      },\n      // Backward compatability\n      pageInfo: function pageInfoFromParent() {\n        var msgBody = getData();\n        log('PageInfoFromParent called from parent: ' + msgBody);\n        onPageInfo(JSON.parse(msgBody));\n        log(' --');\n      },\n      message: function messageFromParent() {\n        var msgBody = getData();\n        log('onMessage called from parent: ' + msgBody); // eslint-disable-next-line sonarjs/no-extra-arguments\n\n        onMessage(JSON.parse(msgBody));\n        log(' --');\n      }\n    };\n\n    function isMessageForUs() {\n      return msgID === ('' + event.data).substr(0, msgIdLen); // ''+ Protects against non-string messages\n    }\n\n    function getMessageType() {\n      return event.data.split(']')[1].split(':')[0];\n    }\n\n    function getData() {\n      return event.data.substr(event.data.indexOf(':') + 1);\n    }\n\n    function isMiddleTier() {\n      return !(typeof module !== 'undefined' && module.exports) && 'iFrameResize' in window || 'jQuery' in window && 'iFrameResize' in window.jQuery.prototype;\n    }\n\n    function isInitMsg() {\n      // Test if this message is from a child below us. This is an ugly test, however, updating\n      // the message format would break backwards compatibity.\n      return event.data.split(':')[2] in {\n        true: 1,\n        false: 1\n      };\n    }\n\n    function callFromParent() {\n      var messageType = getMessageType();\n\n      if (messageType in processRequestFromParent) {\n        processRequestFromParent[messageType]();\n      } else if (!isMiddleTier() && !isInitMsg()) {\n        warn('Unexpected message (' + event.data + ')');\n      }\n    }\n\n    function processMessage() {\n      if (false === firstRun) {\n        callFromParent();\n      } else if (isInitMsg()) {\n        processRequestFromParent.init();\n      } else {\n        log('Ignored message of type \"' + getMessageType() + '\". Received before initialization.');\n      }\n    }\n\n    if (isMessageForUs()) {\n      processMessage();\n    }\n  } // Normally the parent kicks things off when it detects the iFrame has loaded.\n  // If this script is async-loaded, then tell parent page to retry init.\n\n\n  function chkLateLoaded() {\n    if ('loading' !== document.readyState) {\n      window.parent.postMessage('[iFrameResizerChild]Ready', '*');\n    }\n  }\n\n  addEventListener(window, 'message', receiver);\n  addEventListener(window, 'readystatechange', chkLateLoaded);\n  chkLateLoaded();\n})();","map":{"version":3,"sources":["/Users/lizkane/Desktop/GA/SEI/Projects/2ReactPortfolio/portfolio-app-2/portfolio-kane/node_modules/iframe-resizer/js/iframeResizer.contentWindow.js"],"names":["undefined","window","autoResize","base","bodyBackground","bodyMargin","bodyMarginStr","bodyObserver","bodyPadding","calculateWidth","doubleEventList","resize","click","eventCancelTimer","firstRun","height","heightCalcModeDefault","heightCalcMode","initLock","initMsg","inPageLinks","interval","intervalTimer","logging","msgID","msgIdLen","length","myID","resetRequiredMethods","max","min","bodyScroll","documentElementScroll","resizeFrom","sendPermit","target","parent","targetOriginDefault","tolerance","triggerLocked","triggerLockedTimer","throttledTimer","width","widthCalcModeDefault","widthCalcMode","win","onMessage","warn","onReady","onPageInfo","customCalcMethods","document","documentElement","offsetHeight","body","scrollWidth","eventHandlersByName","passiveSupported","noop","options","Object","create","passive","get","addEventListener","removeEventListener","error","el","evt","func","capitalizeFirstLetter","string","charAt","toUpperCase","slice","throttle","context","args","result","timeout","previous","later","getNow","apply","now","remaining","arguments","clearTimeout","setTimeout","Date","getTime","formatLogMsg","msg","log","console","init","readDataFromParent","location","href","readDataFromPage","setMargin","setBodyStyle","injectClearFixIntoBodyElement","checkHeightMode","checkWidthMode","stopInfiniteResizingOfIFrame","setupPublicMethods","startEventListeners","setupInPageLinks","sendSize","strBool","str","data","substr","split","Number","enable","depricate","key","splitName","name","readData","iFrameResizer","JSON","stringify","keys","forEach","targetOrigin","heightCalculationMethod","widthCalculationMethod","setupCustomCalcMethods","calcMode","calcFunc","constructor","chkCSS","attr","value","indexOf","style","manageTriggerEvent","listener","add","eventName","handleEvent","eventType","remove","eventNames","Array","prototype","map","method","manageEventListeners","checkCalcMode","calcModeDefault","modes","type","getHeight","getWidth","setupMutationObserver","disconnectMutationObserver","disconnect","stopEventListeners","clearInterval","clearFix","createElement","clear","display","appendChild","getPagePosition","x","pageXOffset","scrollLeft","y","pageYOffset","scrollTop","getElementPosition","elPosition","getBoundingClientRect","pagePosition","parseInt","left","top","findTarget","jumpToTarget","jumpPosition","hash","sendMsg","hashData","decodeURIComponent","getElementById","getElementsByName","checkLocationHash","bindAnchors","setupLink","linkClicked","e","preventDefault","getAttribute","call","querySelectorAll","bindLocationHash","initCheck","enableInPageLinks","parentIFrame","autoResizeF","close","closeF","getId","getIdF","getPageInfo","getPageInfoF","callback","moveToAnchor","moveToAnchorF","reset","resetF","resetIFrame","scrollTo","scrollToF","scrollToOffset","sendMessage","sendMessageF","setHeightCalculationMethod","setHeightCalculationMethodF","setWidthCalculationMethod","setWidthCalculationMethodF","setTargetOrigin","setTargetOriginF","size","sizeF","customHeight","customWidth","valString","initInterval","setInterval","Math","abs","setupBodyMutationObserver","addImageLoadListners","mutation","addImageLoadListener","element","complete","src","imageLoaded","imageError","elements","push","attributeName","removeFromArray","splice","removeImageLoadListener","imageEventTriggered","event","typeDesc","mutationObserved","mutations","createMutationObserver","querySelector","config","attributes","attributeOldValue","characterData","characterDataOldValue","childList","subtree","observer","MutationObserver","observe","WebKitMutationObserver","forceIntervalTimer","getComputedStyle","prop","retVal","defaultView","chkEventThottle","timer","getMaxElement","side","elementsLength","elVal","maxVal","Side","i","getAllMeasurements","dimention","bodyOffset","documentElementOffset","getTaggedElements","tag","noTaggedElementsFound","getAllElements","getBodyOffsetHeight","offset","getBodyScrollHeight","scrollHeight","custom","getCustomWidth","getDEOffsetHeight","getDEScrollHeight","getMaxHeight","getMinHeight","grow","growHeight","lowestElement","getBestHeight","taggedElement","getTaggedElementsHeight","getBodyScrollWidth","getBodyOffsetWidth","offsetWidth","getDEScrollWidth","getDEOffsetWidth","scroll","getMaxWidth","getMinWidth","rightMostElement","getTaggedElementsWidth","sizeIFrame","triggerEvent","triggerEventDesc","resizeIFrame","currentHeight","currentWidth","isSizeChangeDetected","checkTolarance","a","b","isForceResizableEvent","isForceResizableCalcMode","logIgnored","checkDownSizing","lockTrigger","sizeIFrameThrottled","recordTrigger","resetPage","isDoubleFiredEvent","triggerReset","hcm","sendToParent","message","postMessage","receiver","processRequestFromParent","initFromParent","source","resetFromParent","resizeFromParent","getData","inPageLink","inPageLinkF","pageInfo","pageInfoFromParent","msgBody","parse","messageFromParent","isMessageForUs","getMessageType","isMiddleTier","module","exports","jQuery","isInitMsg","true","false","callFromParent","messageType","processMessage","chkLateLoaded","readyState"],"mappings":"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","sourcesContent":["/*\n * File: iframeResizer.contentWindow.js\n * Desc: Include this file in any page being loaded into an iframe\n *       to force the iframe to resize to the content size.\n * Requires: iframeResizer.js on host page.\n * Doc: https://github.com/davidjbradshaw/iframe-resizer\n * Author: David J. Bradshaw - dave@bradshaw.net\n *\n */\n\n// eslint-disable-next-line sonarjs/cognitive-complexity, no-shadow-restricted-names\n;(function (undefined) {\n  if (typeof window === 'undefined') return // don't run for server side render\n\n  var autoResize = true,\n    base = 10,\n    bodyBackground = '',\n    bodyMargin = 0,\n    bodyMarginStr = '',\n    bodyObserver = null,\n    bodyPadding = '',\n    calculateWidth = false,\n    doubleEventList = { resize: 1, click: 1 },\n    eventCancelTimer = 128,\n    firstRun = true,\n    height = 1,\n    heightCalcModeDefault = 'bodyOffset',\n    heightCalcMode = heightCalcModeDefault,\n    initLock = true,\n    initMsg = '',\n    inPageLinks = {},\n    interval = 32,\n    intervalTimer = null,\n    logging = false,\n    msgID = '[iFrameSizer]', // Must match host page msg ID\n    msgIdLen = msgID.length,\n    myID = '',\n    resetRequiredMethods = {\n      max: 1,\n      min: 1,\n      bodyScroll: 1,\n      documentElementScroll: 1\n    },\n    resizeFrom = 'child',\n    sendPermit = true,\n    target = window.parent,\n    targetOriginDefault = '*',\n    tolerance = 0,\n    triggerLocked = false,\n    triggerLockedTimer = null,\n    throttledTimer = 16,\n    width = 1,\n    widthCalcModeDefault = 'scroll',\n    widthCalcMode = widthCalcModeDefault,\n    win = window,\n    onMessage = function () {\n      warn('onMessage function not defined')\n    },\n    onReady = function () {},\n    onPageInfo = function () {},\n    customCalcMethods = {\n      height: function () {\n        warn('Custom height calculation function not defined')\n        return document.documentElement.offsetHeight\n      },\n      width: function () {\n        warn('Custom width calculation function not defined')\n        return document.body.scrollWidth\n      }\n    },\n    eventHandlersByName = {},\n    passiveSupported = false\n\n  function noop() {}\n\n  try {\n    var options = Object.create(\n      {},\n      {\n        passive: {\n          get: function () {\n            passiveSupported = true\n          }\n        }\n      }\n    )\n    window.addEventListener('test', noop, options)\n    window.removeEventListener('test', noop, options)\n  } catch (error) {\n    /* */\n  }\n\n  function addEventListener(el, evt, func, options) {\n    el.addEventListener(evt, func, passiveSupported ? options || {} : false)\n  }\n\n  function removeEventListener(el, evt, func) {\n    el.removeEventListener(evt, func, false)\n  }\n\n  function capitalizeFirstLetter(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1)\n  }\n\n  // Based on underscore.js\n  function throttle(func) {\n    var context,\n      args,\n      result,\n      timeout = null,\n      previous = 0,\n      later = function () {\n        previous = getNow()\n        timeout = null\n        result = func.apply(context, args)\n        if (!timeout) {\n          // eslint-disable-next-line no-multi-assign\n          context = args = null\n        }\n      }\n\n    return function () {\n      var now = getNow()\n\n      if (!previous) {\n        previous = now\n      }\n\n      var remaining = throttledTimer - (now - previous)\n\n      context = this\n      args = arguments\n\n      if (remaining <= 0 || remaining > throttledTimer) {\n        if (timeout) {\n          clearTimeout(timeout)\n          timeout = null\n        }\n\n        previous = now\n        result = func.apply(context, args)\n\n        if (!timeout) {\n          // eslint-disable-next-line no-multi-assign\n          context = args = null\n        }\n      } else if (!timeout) {\n        timeout = setTimeout(later, remaining)\n      }\n\n      return result\n    }\n  }\n\n  var getNow =\n    Date.now ||\n    function () {\n      /* istanbul ignore next */ // Not testable in PhantonJS\n      return new Date().getTime()\n    }\n\n  function formatLogMsg(msg) {\n    return msgID + '[' + myID + '] ' + msg\n  }\n\n  function log(msg) {\n    if (logging && 'object' === typeof window.console) {\n      // eslint-disable-next-line no-console\n      console.log(formatLogMsg(msg))\n    }\n  }\n\n  function warn(msg) {\n    if ('object' === typeof window.console) {\n      // eslint-disable-next-line no-console\n      console.warn(formatLogMsg(msg))\n    }\n  }\n\n  function init() {\n    readDataFromParent()\n    log('Initialising iFrame (' + location.href + ')')\n    readDataFromPage()\n    setMargin()\n    setBodyStyle('background', bodyBackground)\n    setBodyStyle('padding', bodyPadding)\n    injectClearFixIntoBodyElement()\n    checkHeightMode()\n    checkWidthMode()\n    stopInfiniteResizingOfIFrame()\n    setupPublicMethods()\n    startEventListeners()\n    inPageLinks = setupInPageLinks()\n    sendSize('init', 'Init message from host page')\n    onReady()\n  }\n\n  function readDataFromParent() {\n    function strBool(str) {\n      return 'true' === str\n    }\n\n    var data = initMsg.substr(msgIdLen).split(':')\n\n    myID = data[0]\n    bodyMargin = undefined !== data[1] ? Number(data[1]) : bodyMargin // For V1 compatibility\n    calculateWidth = undefined !== data[2] ? strBool(data[2]) : calculateWidth\n    logging = undefined !== data[3] ? strBool(data[3]) : logging\n    interval = undefined !== data[4] ? Number(data[4]) : interval\n    autoResize = undefined !== data[6] ? strBool(data[6]) : autoResize\n    bodyMarginStr = data[7]\n    heightCalcMode = undefined !== data[8] ? data[8] : heightCalcMode\n    bodyBackground = data[9]\n    bodyPadding = data[10]\n    tolerance = undefined !== data[11] ? Number(data[11]) : tolerance\n    inPageLinks.enable = undefined !== data[12] ? strBool(data[12]) : false\n    resizeFrom = undefined !== data[13] ? data[13] : resizeFrom\n    widthCalcMode = undefined !== data[14] ? data[14] : widthCalcMode\n  }\n\n  function depricate(key) {\n    var splitName = key.split('Callback')\n\n    if (splitName.length === 2) {\n      var name =\n        'on' + splitName[0].charAt(0).toUpperCase() + splitName[0].slice(1)\n      this[name] = this[key]\n      delete this[key]\n      warn(\n        \"Deprecated: '\" +\n          key +\n          \"' has been renamed '\" +\n          name +\n          \"'. The old method will be removed in the next major version.\"\n      )\n    }\n  }\n\n  function readDataFromPage() {\n    function readData() {\n      var data = window.iFrameResizer\n\n      log('Reading data from page: ' + JSON.stringify(data))\n      Object.keys(data).forEach(depricate, data)\n\n      onMessage = 'onMessage' in data ? data.onMessage : onMessage\n      onReady = 'onReady' in data ? data.onReady : onReady\n      targetOriginDefault =\n        'targetOrigin' in data ? data.targetOrigin : targetOriginDefault\n      heightCalcMode =\n        'heightCalculationMethod' in data\n          ? data.heightCalculationMethod\n          : heightCalcMode\n      widthCalcMode =\n        'widthCalculationMethod' in data\n          ? data.widthCalculationMethod\n          : widthCalcMode\n    }\n\n    function setupCustomCalcMethods(calcMode, calcFunc) {\n      if ('function' === typeof calcMode) {\n        log('Setup custom ' + calcFunc + 'CalcMethod')\n        customCalcMethods[calcFunc] = calcMode\n        calcMode = 'custom'\n      }\n\n      return calcMode\n    }\n\n    if (\n      'iFrameResizer' in window &&\n      Object === window.iFrameResizer.constructor\n    ) {\n      readData()\n      heightCalcMode = setupCustomCalcMethods(heightCalcMode, 'height')\n      widthCalcMode = setupCustomCalcMethods(widthCalcMode, 'width')\n    }\n\n    log('TargetOrigin for parent set to: ' + targetOriginDefault)\n  }\n\n  function chkCSS(attr, value) {\n    if (-1 !== value.indexOf('-')) {\n      warn('Negative CSS value ignored for ' + attr)\n      value = ''\n    }\n    return value\n  }\n\n  function setBodyStyle(attr, value) {\n    if (undefined !== value && '' !== value && 'null' !== value) {\n      document.body.style[attr] = value\n      log('Body ' + attr + ' set to \"' + value + '\"')\n    }\n  }\n\n  function setMargin() {\n    // If called via V1 script, convert bodyMargin from int to str\n    if (undefined === bodyMarginStr) {\n      bodyMarginStr = bodyMargin + 'px'\n    }\n\n    setBodyStyle('margin', chkCSS('margin', bodyMarginStr))\n  }\n\n  function stopInfiniteResizingOfIFrame() {\n    document.documentElement.style.height = ''\n    document.body.style.height = ''\n    log('HTML & body height set to \"auto\"')\n  }\n\n  function manageTriggerEvent(options) {\n    var listener = {\n      add: function (eventName) {\n        function handleEvent() {\n          sendSize(options.eventName, options.eventType)\n        }\n\n        eventHandlersByName[eventName] = handleEvent\n\n        addEventListener(window, eventName, handleEvent, { passive: true })\n      },\n      remove: function (eventName) {\n        var handleEvent = eventHandlersByName[eventName]\n        delete eventHandlersByName[eventName]\n\n        removeEventListener(window, eventName, handleEvent)\n      }\n    }\n\n    if (options.eventNames && Array.prototype.map) {\n      options.eventName = options.eventNames[0]\n      options.eventNames.map(listener[options.method])\n    } else {\n      listener[options.method](options.eventName)\n    }\n\n    log(\n      capitalizeFirstLetter(options.method) +\n        ' event listener: ' +\n        options.eventType\n    )\n  }\n\n  function manageEventListeners(method) {\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Animation Start',\n      eventNames: ['animationstart', 'webkitAnimationStart']\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Animation Iteration',\n      eventNames: ['animationiteration', 'webkitAnimationIteration']\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Animation End',\n      eventNames: ['animationend', 'webkitAnimationEnd']\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Input',\n      eventName: 'input'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Mouse Up',\n      eventName: 'mouseup'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Mouse Down',\n      eventName: 'mousedown'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Orientation Change',\n      eventName: 'orientationchange'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Print',\n      eventName: ['afterprint', 'beforeprint']\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Ready State Change',\n      eventName: 'readystatechange'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Touch Start',\n      eventName: 'touchstart'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Touch End',\n      eventName: 'touchend'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Touch Cancel',\n      eventName: 'touchcancel'\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Transition Start',\n      eventNames: [\n        'transitionstart',\n        'webkitTransitionStart',\n        'MSTransitionStart',\n        'oTransitionStart',\n        'otransitionstart'\n      ]\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Transition Iteration',\n      eventNames: [\n        'transitioniteration',\n        'webkitTransitionIteration',\n        'MSTransitionIteration',\n        'oTransitionIteration',\n        'otransitioniteration'\n      ]\n    })\n    manageTriggerEvent({\n      method: method,\n      eventType: 'Transition End',\n      eventNames: [\n        'transitionend',\n        'webkitTransitionEnd',\n        'MSTransitionEnd',\n        'oTransitionEnd',\n        'otransitionend'\n      ]\n    })\n    if ('child' === resizeFrom) {\n      manageTriggerEvent({\n        method: method,\n        eventType: 'IFrame Resized',\n        eventName: 'resize'\n      })\n    }\n  }\n\n  function checkCalcMode(calcMode, calcModeDefault, modes, type) {\n    if (calcModeDefault !== calcMode) {\n      if (!(calcMode in modes)) {\n        warn(\n          calcMode + ' is not a valid option for ' + type + 'CalculationMethod.'\n        )\n        calcMode = calcModeDefault\n      }\n      log(type + ' calculation method set to \"' + calcMode + '\"')\n    }\n\n    return calcMode\n  }\n\n  function checkHeightMode() {\n    heightCalcMode = checkCalcMode(\n      heightCalcMode,\n      heightCalcModeDefault,\n      getHeight,\n      'height'\n    )\n  }\n\n  function checkWidthMode() {\n    widthCalcMode = checkCalcMode(\n      widthCalcMode,\n      widthCalcModeDefault,\n      getWidth,\n      'width'\n    )\n  }\n\n  function startEventListeners() {\n    if (true === autoResize) {\n      manageEventListeners('add')\n      setupMutationObserver()\n    } else {\n      log('Auto Resize disabled')\n    }\n  }\n\n  //   function stopMsgsToParent() {\n  //     log('Disable outgoing messages')\n  //     sendPermit = false\n  //   }\n\n  //   function removeMsgListener() {\n  //     log('Remove event listener: Message')\n  //     removeEventListener(window, 'message', receiver)\n  //   }\n\n  function disconnectMutationObserver() {\n    if (null !== bodyObserver) {\n      /* istanbul ignore next */ // Not testable in PhantonJS\n      bodyObserver.disconnect()\n    }\n  }\n\n  function stopEventListeners() {\n    manageEventListeners('remove')\n    disconnectMutationObserver()\n    clearInterval(intervalTimer)\n  }\n\n  //   function teardown() {\n  //     stopMsgsToParent()\n  //     removeMsgListener()\n  //     if (true === autoResize) stopEventListeners()\n  //   }\n\n  function injectClearFixIntoBodyElement() {\n    var clearFix = document.createElement('div')\n    clearFix.style.clear = 'both'\n    // Guard against the following having been globally redefined in CSS.\n    clearFix.style.display = 'block'\n    clearFix.style.height = '0'\n    document.body.appendChild(clearFix)\n  }\n\n  function setupInPageLinks() {\n    function getPagePosition() {\n      return {\n        x:\n          window.pageXOffset !== undefined\n            ? window.pageXOffset\n            : document.documentElement.scrollLeft,\n        y:\n          window.pageYOffset !== undefined\n            ? window.pageYOffset\n            : document.documentElement.scrollTop\n      }\n    }\n\n    function getElementPosition(el) {\n      var elPosition = el.getBoundingClientRect(),\n        pagePosition = getPagePosition()\n\n      return {\n        x: parseInt(elPosition.left, 10) + parseInt(pagePosition.x, 10),\n        y: parseInt(elPosition.top, 10) + parseInt(pagePosition.y, 10)\n      }\n    }\n\n    function findTarget(location) {\n      function jumpToTarget(target) {\n        var jumpPosition = getElementPosition(target)\n\n        log(\n          'Moving to in page link (#' +\n            hash +\n            ') at x: ' +\n            jumpPosition.x +\n            ' y: ' +\n            jumpPosition.y\n        )\n        sendMsg(jumpPosition.y, jumpPosition.x, 'scrollToOffset') // X&Y reversed at sendMsg uses height/width\n      }\n\n      var hash = location.split('#')[1] || location, // Remove # if present\n        hashData = decodeURIComponent(hash),\n        target =\n          document.getElementById(hashData) ||\n          document.getElementsByName(hashData)[0]\n\n      if (undefined !== target) {\n        jumpToTarget(target)\n      } else {\n        log(\n          'In page link (#' +\n            hash +\n            ') not found in iFrame, so sending to parent'\n        )\n        sendMsg(0, 0, 'inPageLink', '#' + hash)\n      }\n    }\n\n    function checkLocationHash() {\n      if ('' !== location.hash && '#' !== location.hash) {\n        findTarget(location.href)\n      }\n    }\n\n    function bindAnchors() {\n      function setupLink(el) {\n        function linkClicked(e) {\n          e.preventDefault()\n\n          /* jshint validthis:true */\n          findTarget(this.getAttribute('href'))\n        }\n\n        if ('#' !== el.getAttribute('href')) {\n          addEventListener(el, 'click', linkClicked)\n        }\n      }\n\n      Array.prototype.forEach.call(\n        document.querySelectorAll('a[href^=\"#\"]'),\n        setupLink\n      )\n    }\n\n    function bindLocationHash() {\n      addEventListener(window, 'hashchange', checkLocationHash)\n    }\n\n    function initCheck() {\n      // Check if page loaded with location hash after init resize\n      setTimeout(checkLocationHash, eventCancelTimer)\n    }\n\n    function enableInPageLinks() {\n      /* istanbul ignore else */ // Not testable in phantonJS\n      if (Array.prototype.forEach && document.querySelectorAll) {\n        log('Setting up location.hash handlers')\n        bindAnchors()\n        bindLocationHash()\n        initCheck()\n      } else {\n        warn(\n          'In page linking not fully supported in this browser! (See README.md for IE8 workaround)'\n        )\n      }\n    }\n\n    if (inPageLinks.enable) {\n      enableInPageLinks()\n    } else {\n      log('In page linking not enabled')\n    }\n\n    return {\n      findTarget: findTarget\n    }\n  }\n\n  function setupPublicMethods() {\n    log('Enable public methods')\n\n    win.parentIFrame = {\n      autoResize: function autoResizeF(resize) {\n        if (true === resize && false === autoResize) {\n          autoResize = true\n          startEventListeners()\n        } else if (false === resize && true === autoResize) {\n          autoResize = false\n          stopEventListeners()\n        }\n        sendMsg(0, 0, 'autoResize', JSON.stringify(autoResize))\n        return autoResize\n      },\n\n      close: function closeF() {\n        sendMsg(0, 0, 'close')\n        // teardown()\n      },\n\n      getId: function getIdF() {\n        return myID\n      },\n\n      getPageInfo: function getPageInfoF(callback) {\n        if ('function' === typeof callback) {\n          onPageInfo = callback\n          sendMsg(0, 0, 'pageInfo')\n        } else {\n          onPageInfo = function () {}\n          sendMsg(0, 0, 'pageInfoStop')\n        }\n      },\n\n      moveToAnchor: function moveToAnchorF(hash) {\n        inPageLinks.findTarget(hash)\n      },\n\n      reset: function resetF() {\n        resetIFrame('parentIFrame.reset')\n      },\n\n      scrollTo: function scrollToF(x, y) {\n        sendMsg(y, x, 'scrollTo') // X&Y reversed at sendMsg uses height/width\n      },\n\n      scrollToOffset: function scrollToF(x, y) {\n        sendMsg(y, x, 'scrollToOffset') // X&Y reversed at sendMsg uses height/width\n      },\n\n      sendMessage: function sendMessageF(msg, targetOrigin) {\n        sendMsg(0, 0, 'message', JSON.stringify(msg), targetOrigin)\n      },\n\n      setHeightCalculationMethod: function setHeightCalculationMethodF(\n        heightCalculationMethod\n      ) {\n        heightCalcMode = heightCalculationMethod\n        checkHeightMode()\n      },\n\n      setWidthCalculationMethod: function setWidthCalculationMethodF(\n        widthCalculationMethod\n      ) {\n        widthCalcMode = widthCalculationMethod\n        checkWidthMode()\n      },\n\n      setTargetOrigin: function setTargetOriginF(targetOrigin) {\n        log('Set targetOrigin: ' + targetOrigin)\n        targetOriginDefault = targetOrigin\n      },\n\n      size: function sizeF(customHeight, customWidth) {\n        var valString =\n          '' + (customHeight || '') + (customWidth ? ',' + customWidth : '')\n        sendSize(\n          'size',\n          'parentIFrame.size(' + valString + ')',\n          customHeight,\n          customWidth\n        )\n      }\n    }\n  }\n\n  function initInterval() {\n    if (0 !== interval) {\n      log('setInterval: ' + interval + 'ms')\n      intervalTimer = setInterval(function () {\n        sendSize('interval', 'setInterval: ' + interval)\n      }, Math.abs(interval))\n    }\n  }\n\n  // Not testable in PhantomJS\n  /* istanbul ignore next */\n  function setupBodyMutationObserver() {\n    function addImageLoadListners(mutation) {\n      function addImageLoadListener(element) {\n        if (false === element.complete) {\n          log('Attach listeners to ' + element.src)\n          element.addEventListener('load', imageLoaded, false)\n          element.addEventListener('error', imageError, false)\n          elements.push(element)\n        }\n      }\n\n      if (mutation.type === 'attributes' && mutation.attributeName === 'src') {\n        addImageLoadListener(mutation.target)\n      } else if (mutation.type === 'childList') {\n        Array.prototype.forEach.call(\n          mutation.target.querySelectorAll('img'),\n          addImageLoadListener\n        )\n      }\n    }\n\n    function removeFromArray(element) {\n      elements.splice(elements.indexOf(element), 1)\n    }\n\n    function removeImageLoadListener(element) {\n      log('Remove listeners from ' + element.src)\n      element.removeEventListener('load', imageLoaded, false)\n      element.removeEventListener('error', imageError, false)\n      removeFromArray(element)\n    }\n\n    function imageEventTriggered(event, type, typeDesc) {\n      removeImageLoadListener(event.target)\n      sendSize(type, typeDesc + ': ' + event.target.src, undefined, undefined)\n    }\n\n    function imageLoaded(event) {\n      imageEventTriggered(event, 'imageLoad', 'Image loaded')\n    }\n\n    function imageError(event) {\n      imageEventTriggered(event, 'imageLoadFailed', 'Image load failed')\n    }\n\n    function mutationObserved(mutations) {\n      sendSize(\n        'mutationObserver',\n        'mutationObserver: ' + mutations[0].target + ' ' + mutations[0].type\n      )\n\n      // Deal with WebKit / Blink asyncing image loading when tags are injected into the page\n      mutations.forEach(addImageLoadListners)\n    }\n\n    function createMutationObserver() {\n      var target = document.querySelector('body'),\n        config = {\n          attributes: true,\n          attributeOldValue: false,\n          characterData: true,\n          characterDataOldValue: false,\n          childList: true,\n          subtree: true\n        }\n\n      observer = new MutationObserver(mutationObserved)\n\n      log('Create body MutationObserver')\n      observer.observe(target, config)\n\n      return observer\n    }\n\n    var elements = [],\n      MutationObserver =\n        window.MutationObserver || window.WebKitMutationObserver,\n      observer = createMutationObserver()\n\n    return {\n      disconnect: function () {\n        if ('disconnect' in observer) {\n          log('Disconnect body MutationObserver')\n          observer.disconnect()\n          elements.forEach(removeImageLoadListener)\n        }\n      }\n    }\n  }\n\n  function setupMutationObserver() {\n    var forceIntervalTimer = 0 > interval\n\n    // Not testable in PhantomJS\n    /* istanbul ignore if */ if (\n      window.MutationObserver ||\n      window.WebKitMutationObserver\n    ) {\n      if (forceIntervalTimer) {\n        initInterval()\n      } else {\n        bodyObserver = setupBodyMutationObserver()\n      }\n    } else {\n      log('MutationObserver not supported in this browser!')\n      initInterval()\n    }\n  }\n\n  // document.documentElement.offsetHeight is not reliable, so\n  // we have to jump through hoops to get a better value.\n  function getComputedStyle(prop, el) {\n    var retVal = 0\n    el = el || document.body // Not testable in phantonJS\n\n    retVal = document.defaultView.getComputedStyle(el, null)\n    retVal = null !== retVal ? retVal[prop] : 0\n\n    return parseInt(retVal, base)\n  }\n\n  function chkEventThottle(timer) {\n    if (timer > throttledTimer / 2) {\n      throttledTimer = 2 * timer\n      log('Event throttle increased to ' + throttledTimer + 'ms')\n    }\n  }\n\n  // Idea from https://github.com/guardian/iframe-messenger\n  function getMaxElement(side, elements) {\n    var elementsLength = elements.length,\n      elVal = 0,\n      maxVal = 0,\n      Side = capitalizeFirstLetter(side),\n      timer = getNow()\n\n    for (var i = 0; i < elementsLength; i++) {\n      elVal =\n        elements[i].getBoundingClientRect()[side] +\n        getComputedStyle('margin' + Side, elements[i])\n      if (elVal > maxVal) {\n        maxVal = elVal\n      }\n    }\n\n    timer = getNow() - timer\n\n    log('Parsed ' + elementsLength + ' HTML elements')\n    log('Element position calculated in ' + timer + 'ms')\n\n    chkEventThottle(timer)\n\n    return maxVal\n  }\n\n  function getAllMeasurements(dimention) {\n    return [\n      dimention.bodyOffset(),\n      dimention.bodyScroll(),\n      dimention.documentElementOffset(),\n      dimention.documentElementScroll()\n    ]\n  }\n\n  function getTaggedElements(side, tag) {\n    function noTaggedElementsFound() {\n      warn('No tagged elements (' + tag + ') found on page')\n      return document.querySelectorAll('body *')\n    }\n\n    var elements = document.querySelectorAll('[' + tag + ']')\n\n    if (0 === elements.length) noTaggedElementsFound()\n\n    return getMaxElement(side, elements)\n  }\n\n  function getAllElements() {\n    return document.querySelectorAll('body *')\n  }\n\n  var getHeight = {\n      bodyOffset: function getBodyOffsetHeight() {\n        return (\n          document.body.offsetHeight +\n          getComputedStyle('marginTop') +\n          getComputedStyle('marginBottom')\n        )\n      },\n\n      offset: function () {\n        return getHeight.bodyOffset() // Backwards compatability\n      },\n\n      bodyScroll: function getBodyScrollHeight() {\n        return document.body.scrollHeight\n      },\n\n      custom: function getCustomWidth() {\n        return customCalcMethods.height()\n      },\n\n      documentElementOffset: function getDEOffsetHeight() {\n        return document.documentElement.offsetHeight\n      },\n\n      documentElementScroll: function getDEScrollHeight() {\n        return document.documentElement.scrollHeight\n      },\n\n      max: function getMaxHeight() {\n        return Math.max.apply(null, getAllMeasurements(getHeight))\n      },\n\n      min: function getMinHeight() {\n        return Math.min.apply(null, getAllMeasurements(getHeight))\n      },\n\n      grow: function growHeight() {\n        return getHeight.max() // Run max without the forced downsizing\n      },\n\n      lowestElement: function getBestHeight() {\n        return Math.max(\n          getHeight.bodyOffset() || getHeight.documentElementOffset(),\n          getMaxElement('bottom', getAllElements())\n        )\n      },\n\n      taggedElement: function getTaggedElementsHeight() {\n        return getTaggedElements('bottom', 'data-iframe-height')\n      }\n    },\n    getWidth = {\n      bodyScroll: function getBodyScrollWidth() {\n        return document.body.scrollWidth\n      },\n\n      bodyOffset: function getBodyOffsetWidth() {\n        return document.body.offsetWidth\n      },\n\n      custom: function getCustomWidth() {\n        return customCalcMethods.width()\n      },\n\n      documentElementScroll: function getDEScrollWidth() {\n        return document.documentElement.scrollWidth\n      },\n\n      documentElementOffset: function getDEOffsetWidth() {\n        return document.documentElement.offsetWidth\n      },\n\n      scroll: function getMaxWidth() {\n        return Math.max(getWidth.bodyScroll(), getWidth.documentElementScroll())\n      },\n\n      max: function getMaxWidth() {\n        return Math.max.apply(null, getAllMeasurements(getWidth))\n      },\n\n      min: function getMinWidth() {\n        return Math.min.apply(null, getAllMeasurements(getWidth))\n      },\n\n      rightMostElement: function rightMostElement() {\n        return getMaxElement('right', getAllElements())\n      },\n\n      taggedElement: function getTaggedElementsWidth() {\n        return getTaggedElements('right', 'data-iframe-width')\n      }\n    }\n\n  function sizeIFrame(\n    triggerEvent,\n    triggerEventDesc,\n    customHeight,\n    customWidth\n  ) {\n    function resizeIFrame() {\n      height = currentHeight\n      width = currentWidth\n\n      sendMsg(height, width, triggerEvent)\n    }\n\n    function isSizeChangeDetected() {\n      function checkTolarance(a, b) {\n        var retVal = Math.abs(a - b) <= tolerance\n        return !retVal\n      }\n\n      currentHeight =\n        undefined !== customHeight ? customHeight : getHeight[heightCalcMode]()\n      currentWidth =\n        undefined !== customWidth ? customWidth : getWidth[widthCalcMode]()\n\n      return (\n        checkTolarance(height, currentHeight) ||\n        (calculateWidth && checkTolarance(width, currentWidth))\n      )\n    }\n\n    function isForceResizableEvent() {\n      return !(triggerEvent in { init: 1, interval: 1, size: 1 })\n    }\n\n    function isForceResizableCalcMode() {\n      return (\n        heightCalcMode in resetRequiredMethods ||\n        (calculateWidth && widthCalcMode in resetRequiredMethods)\n      )\n    }\n\n    function logIgnored() {\n      log('No change in size detected')\n    }\n\n    function checkDownSizing() {\n      if (isForceResizableEvent() && isForceResizableCalcMode()) {\n        resetIFrame(triggerEventDesc)\n      } else if (!(triggerEvent in { interval: 1 })) {\n        logIgnored()\n      }\n    }\n\n    var currentHeight, currentWidth\n\n    if (isSizeChangeDetected() || 'init' === triggerEvent) {\n      lockTrigger()\n      resizeIFrame()\n    } else {\n      checkDownSizing()\n    }\n  }\n\n  var sizeIFrameThrottled = throttle(sizeIFrame)\n\n  function sendSize(triggerEvent, triggerEventDesc, customHeight, customWidth) {\n    function recordTrigger() {\n      if (!(triggerEvent in { reset: 1, resetPage: 1, init: 1 })) {\n        log('Trigger event: ' + triggerEventDesc)\n      }\n    }\n\n    function isDoubleFiredEvent() {\n      return triggerLocked && triggerEvent in doubleEventList\n    }\n\n    if (!isDoubleFiredEvent()) {\n      recordTrigger()\n      if (triggerEvent === 'init') {\n        sizeIFrame(triggerEvent, triggerEventDesc, customHeight, customWidth)\n      } else {\n        sizeIFrameThrottled(\n          triggerEvent,\n          triggerEventDesc,\n          customHeight,\n          customWidth\n        )\n      }\n    } else {\n      log('Trigger event cancelled: ' + triggerEvent)\n    }\n  }\n\n  function lockTrigger() {\n    if (!triggerLocked) {\n      triggerLocked = true\n      log('Trigger event lock on')\n    }\n    clearTimeout(triggerLockedTimer)\n    triggerLockedTimer = setTimeout(function () {\n      triggerLocked = false\n      log('Trigger event lock off')\n      log('--')\n    }, eventCancelTimer)\n  }\n\n  function triggerReset(triggerEvent) {\n    height = getHeight[heightCalcMode]()\n    width = getWidth[widthCalcMode]()\n\n    sendMsg(height, width, triggerEvent)\n  }\n\n  function resetIFrame(triggerEventDesc) {\n    var hcm = heightCalcMode\n    heightCalcMode = heightCalcModeDefault\n\n    log('Reset trigger event: ' + triggerEventDesc)\n    lockTrigger()\n    triggerReset('reset')\n\n    heightCalcMode = hcm\n  }\n\n  function sendMsg(height, width, triggerEvent, msg, targetOrigin) {\n    function setTargetOrigin() {\n      if (undefined === targetOrigin) {\n        targetOrigin = targetOriginDefault\n      } else {\n        log('Message targetOrigin: ' + targetOrigin)\n      }\n    }\n\n    function sendToParent() {\n      var size = height + ':' + width,\n        message =\n          myID +\n          ':' +\n          size +\n          ':' +\n          triggerEvent +\n          (undefined !== msg ? ':' + msg : '')\n\n      log('Sending message to host page (' + message + ')')\n      target.postMessage(msgID + message, targetOrigin)\n    }\n\n    if (true === sendPermit) {\n      setTargetOrigin()\n      sendToParent()\n    }\n  }\n\n  function receiver(event) {\n    var processRequestFromParent = {\n      init: function initFromParent() {\n        initMsg = event.data\n        target = event.source\n\n        init()\n        firstRun = false\n        setTimeout(function () {\n          initLock = false\n        }, eventCancelTimer)\n      },\n\n      reset: function resetFromParent() {\n        if (!initLock) {\n          log('Page size reset by host page')\n          triggerReset('resetPage')\n        } else {\n          log('Page reset ignored by init')\n        }\n      },\n\n      resize: function resizeFromParent() {\n        sendSize('resizeParent', 'Parent window requested size check')\n      },\n\n      moveToAnchor: function moveToAnchorF() {\n        inPageLinks.findTarget(getData())\n      },\n      inPageLink: function inPageLinkF() {\n        this.moveToAnchor()\n      }, // Backward compatability\n\n      pageInfo: function pageInfoFromParent() {\n        var msgBody = getData()\n        log('PageInfoFromParent called from parent: ' + msgBody)\n        onPageInfo(JSON.parse(msgBody))\n        log(' --')\n      },\n\n      message: function messageFromParent() {\n        var msgBody = getData()\n\n        log('onMessage called from parent: ' + msgBody)\n        // eslint-disable-next-line sonarjs/no-extra-arguments\n        onMessage(JSON.parse(msgBody))\n        log(' --')\n      }\n    }\n\n    function isMessageForUs() {\n      return msgID === ('' + event.data).substr(0, msgIdLen) // ''+ Protects against non-string messages\n    }\n\n    function getMessageType() {\n      return event.data.split(']')[1].split(':')[0]\n    }\n\n    function getData() {\n      return event.data.substr(event.data.indexOf(':') + 1)\n    }\n\n    function isMiddleTier() {\n      return (\n        (!(typeof module !== 'undefined' && module.exports) &&\n          'iFrameResize' in window) ||\n        ('jQuery' in window && 'iFrameResize' in window.jQuery.prototype)\n      )\n    }\n\n    function isInitMsg() {\n      // Test if this message is from a child below us. This is an ugly test, however, updating\n      // the message format would break backwards compatibity.\n      return event.data.split(':')[2] in { true: 1, false: 1 }\n    }\n\n    function callFromParent() {\n      var messageType = getMessageType()\n\n      if (messageType in processRequestFromParent) {\n        processRequestFromParent[messageType]()\n      } else if (!isMiddleTier() && !isInitMsg()) {\n        warn('Unexpected message (' + event.data + ')')\n      }\n    }\n\n    function processMessage() {\n      if (false === firstRun) {\n        callFromParent()\n      } else if (isInitMsg()) {\n        processRequestFromParent.init()\n      } else {\n        log(\n          'Ignored message of type \"' +\n            getMessageType() +\n            '\". Received before initialization.'\n        )\n      }\n    }\n\n    if (isMessageForUs()) {\n      processMessage()\n    }\n  }\n\n  // Normally the parent kicks things off when it detects the iFrame has loaded.\n  // If this script is async-loaded, then tell parent page to retry init.\n  function chkLateLoaded() {\n    if ('loading' !== document.readyState) {\n      window.parent.postMessage('[iFrameResizerChild]Ready', '*')\n    }\n  }\n\n  addEventListener(window, 'message', receiver)\n  addEventListener(window, 'readystatechange', chkLateLoaded)\n  chkLateLoaded()\n\n  \n})()\n"]},"metadata":{},"sourceType":"script"}